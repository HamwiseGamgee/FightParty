using System;
using System.Collections.Generic;

public class FoeType
{
    public string typeName;
    public bool isMagick;
    public double regenPower;
    public int typeSize;
    
    public FoeType(string startTypeName = "Normal", bool spellz = false, double healzz = 0.0, int bigNess = 1)
    {
        typeName = startTypeName;
        isMagick = spellz;
        regenPower = healzz;
        typeSize = bigNess;
    }

    // List of Types of Foes
    public static FoeType normal = new FoeType("Normal", false);
    public static FoeType bigNormal = new FoeType("Normal (But Large)", false, 0.0, 2);
    public static FoeType unDead = new FoeType("Undead", true, 0.1, 1);
}

public class Foe
{
    public int hp;
    public string name;
    public int def;
    public int str;
    public FoeType fighterType;
    
    public Foe(string startName, int health = 1, int defense = 0, int strength = 0, FoeType fightType = null)
    {
        name = startName;
        hp = health;
        def = defense;
        str = strength;
        fighterType = fightType ?? FoeType.normal;
    }
}

class Program
{
    static void Main()
    {
        Foe firstFighter = null;
        Foe secondFighter = null;
        
        Foe goblin = new Foe("Goblin", 7, 0, 2, FoeType.normal);
        Foe skeleton = new Foe("Skeleton", 4, 1, 2, FoeType.unDead);
        Foe giant = new Foe("Giant", 14, 1, 5, FoeType.bigNormal);
        Foe zombie = new Foe("Zombie", 5, 0, 1, FoeType.unDead);

        Dictionary<string, Foe> foes = new Dictionary<string, Foe>
        {
            { goblin.name.ToLower(), goblin },
            { skeleton.name.ToLower(), skeleton },
            { giant.name.ToLower(), giant },
            { zombie.name.ToLower(), zombie },
        };

        FightChoose:
        Console.WriteLine("Enter the name of your first fighter (Goblin, Skeleton, Giant, Zombie). Or type 'pussout' to avoid further bloodshed: ");
        
        firstFighter = SelectFighter(foes);
        if (firstFighter == null) return;

        secondFighter = SelectFighter(foes);
        if (secondFighter == null) return;

        Battle(firstFighter, secondFighter, foes);
    }

    static Foe SelectFighter(Dictionary<string, Foe> foes)
    {
        string fightAnswer = Console.ReadLine()?.Trim().ToLower();
        if (fightAnswer == "pussout") return null;

        if (foes.ContainsKey(fightAnswer))
        {
            Foe selectedFoe = foes[fightAnswer];
            Console.WriteLine($"Your fighter {selectedFoe.name} is selected!");
            return selectedFoe;
        }

        Console.WriteLine("That's not a valid fighter. Try again.");
        return null;
    }

    static void Battle(Foe firstFighter, Foe secondFighter, Dictionary<string, Foe> foes)
    {
        while (firstFighter.hp > 0 && secondFighter.hp > 0)
        {
            Console.WriteLine($"Type 'fight' to start the battle between {firstFighter.name} and {secondFighter.name}!");
            string response = Console.ReadLine()?.Trim().ToLower();

            if (response != "fight")
            {
                Console.WriteLine("Oh, come on! Let them fight!");
                continue;
            }

            PerformAttack(firstFighter, secondFighter);

            if (secondFighter.hp > 0)
                PerformAttack(secondFighter, firstFighter);

            if (firstFighter.hp == 0)
            {
                Console.WriteLine($"{firstFighter.name} has been defeated!");
                break;
            }
            else if (secondFighter.hp == 0)
            {
                Console.WriteLine($"{secondFighter.name} has been defeated!");
                break;
            }
        }
    }

    static void PerformAttack(Foe attacker, Foe defender)
    {
        int damage = CalculateDamage(attacker, defender);
        defender.hp = Math.Max(defender.hp - damage, 0);

        string attackDescription = GenerateAttackDescription(attacker, defender);
        Console.WriteLine(attackDescription);

        if (defender.hp > 0)
        {
            string counterDescription = GenerateCounterDescription(defender, attacker);
            Console.WriteLine(counterDescription);
        }

        Console.WriteLine($"{defender.name} has {defender.hp} HP left.");
        Console.WriteLine($"{attacker.name} has {attacker.hp} HP left.");
    }

    static int CalculateDamage(Foe attacker, Foe defender)
    {
        int damage = attacker.str - defender.def;
        return damage < 0 ? 0 : damage;
    }

    static string GenerateAttackDescription(Foe attacker, Foe defender)
    {
        Random rand = new Random();
        string[] normalGuyAttacks = new string[]
        {
            $"{defender.name} staggers back after the brutal blow from {attacker.name}!",
            $"{defender.name} grunts in pain as the attack from {attacker.name} lands!",
            $"{attacker.name}'s strike hits {defender.name} square in the chest!",
            $"{defender.name} is knocked off balance by the force of {attacker.name}'s attack!",
            $"{attacker.name} lunges and {defender.name} reels from the impact of the hit!"
        };

        return normalGuyAttacks[rand.Next(normalGuyAttacks.Length)];
    }

    static string GenerateCounterDescription(Foe defender, Foe attacker)
    {
        Random rand = new Random();
        string[] descStrikebackNormal = new string[]
        {
            $"{attacker.name} staggers back after the brutal blow from {defender.name}!",
            $"{attacker.name} grunts in pain as the attack from {defender.name} lands!",
            $"{defender.name}'s strike hits {attacker.name} square in the chest!",
            $"{attacker.name} is knocked off balance by the force of {defender.name}'s attack!",
            $"{defender.name} lunges and {attacker.name} reels from the impact of the hit!"
        };

        return descStrikebackNormal[rand.Next(descStrikebackNormal.Length)];
    }
}
